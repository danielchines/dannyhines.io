---
title: 'Betting Odds to Implied Probability Chrome Extension'
description: 'View the most popular news, pictures and memes from a day in Reddit history.'
category: 'Side Project'
publishedAt: '2021-02-24'
techs: 'react,nextjs,ux'
headerImg: 'reddit-time-machine/header.png'
github: 'https://github.com/danielchines/reddit-time-machine'
link: 'https://reddit-time-machine.com'
---

<HeaderImage
  src='/images/betting-odds-extension/header.png'
  alt='header image'
  width={1071}
  height={311}
/>

> View the extension on the [Chrome Web Store](https://chrome.google.com/webstore/detail/odds-to-probability-text/nofjpbibnnkinmfndoknlbkchbecgbkb)

## Background

Betting odds are complex on purpose. Let's say I'm going to flip a coin -
if it's heads I'll give you $10, if it's tails you owe me $11.
If you play this game over and over, it's easy to see why you'd lose money over time.

In the U.S., a 50/50 bet like this should be even odds, or 100 moneyline (wager $100 to win $100).
Because _The House always wins_, casinos and sportsbooks would give you -110 odds to pick either side, or "$110 to win $100".

<Image
  src='/images/betting-odds-extension/i-like-those-odds.jpg'
  alt='I like those odds meme'
  className='mx-auto mb-6 rounded-md'
  imgClassName='rounded-md'
  width={400}
  height={225}
/>

> I'm sure there's an argument why the +260, -180 betting syntax makes more sense,
> but in reality it's just another way that casinos try to distract you from the amount of money you're losing.

Here's an example of an "even" game on Draftkings, where you can bet on the Bills or the Rams to win, both giving you -110 odds:

<Image
  src='/images/betting-odds-extension/betting-odds.png'
  alt='nfl betting odds'
  className='mx-auto my-2 rounded-md'
  imgClassName='rounded-md'
  width={555}
  height={155}
/>

### Implied Probability

Assuming the odds are "fair", the implied probability is the percentage chance that the bet is supposed to win.
In the coin example, it should be 50% for both heads and tails, but at -110, the implied probability is actually 52.4%.
Because sportsbooks charge a fee or "vig" for placing bets, the implied probability is normally higher than the actual probability.
In other words, _you're paying a price that overestimates the chance of something happening_.

> Using the implied probability is simpler way to look at sports betting: a "good bet" is one where you believe the percentage chance is higher than the implied probability.

### Converting odds

There are three main ways to frame odds:

- **Fractional**: The profit / wager.
- **Decimal**: The ratio of the payout amount, including the original stake, to the stake itself.
- **Moneyline/American**:
  - When positive, the figure indicates how much money will be won on a $100 wager.
  - When negative, it indicates how much money must be wagered to win $100.

> For example, 4/1 odds implies you could make $400 profit on a $100 wager. In decimal that would be 5.0, or +400 moneyline.
> For a "$100 to win $25" bet, it would be 1/4 fractional odds, 1.25 for decimal, or -400 in freedom units.

Converting between decimal, fractional, and implied probability is somewhat easy - just do 1 divided by the decimal odds.
If you need to convert a moneyline to a probability, however, it's kinda messy:

If Odds < 0:

- **Probability = (-1\*(Odds)) / (-1(Odds) + 100)**

If Odds > 0:

- **Probability = 100 / (Odds + 100)**

## Building a Chrome Extension

I decided to automate the process by making a Chrome extension to convert the odds for me.
It's a lightweight extension that scans the webpage for instances of American odds (-130, +140, etc), converts it to implied probability as a percentage, and inserts the probability next to the odds.

In javascript, the conversion function looks something like this, where `match` is the moneyline odds as a string:

```js
function replacer(match) {
  const num = parseInt(match.slice(1, match.length));
  let replacement = '';
  if (match[0] === '-') {
    replacement = ((num / (num + 100)) * 100).toFixed(1);
  } else {
    replacement = ((100 / (num + 100)) * 100).toFixed(1);
  }
  return match + ' (' + replacement + '%)';
}
```

When the extension is activated, it runs through this function to replace the text on the page:

```js
function replaceAllText(active) {
  // Replace every text element on the page
  let body = document.getElementsByTagName('body')[0];
  let textNodes = [...body.querySelectorAll('*')]
    .map((l) => [...l.childNodes])
    .flat()
    .filter((l) => l.nodeType === 3);

  for (let i = 0; i < textNodes.length; i++) {
    textNodeInnerHTML(textNodes[i], active);
  }
}
```

Specifically, `textNodeInnerHTML()` is either creating a new div to add to the page, or removing the already-added div if they're toggling off the 'active' state.

```js
unction textNodeInnerHTML(textNode, active) {
  let regex = active ? /([+-])(\d\d\d+)/g : / \(\d*\.\d\%\)/g;
  var div = document.createElement("div");
  textNode.parentNode.insertBefore(div, textNode);
  div.insertAdjacentHTML(
    "afterend",
    textNode.data.replace(regex, active ? replacer : "")
  );
  div.remove();
  textNode.remove();
}

```

And that's pretty much it, other than adding a background script to know when the extension is actually triggered, and adding a listener to call the code above.
For that same Bills Rams game, here's what happens when you click on the extension:

<Image
  src='/images/betting-odds-extension/betting-odds-converted.png'
  alt='nfl betting odds'
  className='mx-auto rounded-md'
  imgClassName='rounded-md'
  width={555}
  height={155}
/>

## Building and deploying to the Chrome Web Store

First I had to register as a [Chrome Web Store Developer](https://developer.chrome.com/docs/webstore/register/).

For my deployment, I put together some images, a description, and used this command to zip it all up:

```bash
zip -r build.zip images/ background.js content_script.js manifest.json
```

And you're ready to upload! Just sign into your developer account and follow the steps to submit your app for review.
